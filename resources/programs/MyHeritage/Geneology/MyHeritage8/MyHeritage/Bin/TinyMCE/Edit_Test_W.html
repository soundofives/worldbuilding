<!DOCTYPE html>
<html>
<head>
<meta http-equiv="X-UA-Compatible" content="IE=7" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
</head>
<body leftmargin="0" topmargin="0" marginwidth="0" marginheight="0" scroll="no">

<script type="text/javascript">
document.write("<textarea rows=\"40\" cols=\"100\" name=\"content\" id=\"content\" style=\"margin:20px;padding:0;\">\n");
//document.write(window.external.GetText());
document.write("</textarea>\n");
</script>

<script type="text/javascript">
function GetText()
{
  return tinyMCE.get('content').getContent();
}
function InsertChar(charToInsert)
{
    tinyMCE.execCommand('mceInsertContent', false, charToInsert);
}
function GetSelectionText() {
    // return tinyMCE.get('selection').getContent();
    return tinyMCE.activeEditor.selection.getContent();
}

function CutSelectedText()
{
    tinyMCE.execCommand('Cut');
}

function CopySelectedText() 
{
    tinyMCE.execCommand('Copy');
}

function PasteText()
{
    tinyMCE.execCommand('Past');
}

</script>

<script id="source" src="tiny_mce.js" type="text/javascript"></script>

<script type="text/javascript">
//source.src = window.external.GetPath() + "tiny_mce.js";
</script>

<script type="text/javascript">
var params = {
        // General options
        mode : "textareas",
        theme : "advanced",
        content_css : ".\TinyMCE.css",
        // editor_css : "TinyMCE.css",

        // For now, disable all plugins
        // plugins : "emotions,iespell,preview,searchreplace,print,table",
		//plugins : "paste",
		//paste_auto_cleanup_on_paste : true,

        // Theme options
        // theme_advanced_buttons1 : "bold, italic, underline, separator,justifyleft, justifycenter, justifyright, justifyfull, separator,bullist, numlist, outdent, indent, separator, hr, separator, search, replace",    	// theme_advanced_buttons2 : "cut, copy, paste, separator, undo, redo, separator, link, unlink, image, separator, charmap, iespell, preview,separator, emotions, separator, print",         theme_advanced_buttons1 : "bold, italic, underline, separator,justifyleft, justifycenter, justifyright, justifyfull, separator,bullist, numlist, outdent, indent, separator, hr",    	theme_advanced_buttons2 : "cut, copy, paste, separator, undo, redo",     	// theme_advanced_buttons3 : "", 
		//theme_advanced_buttons3_add : "pastetext,pasteword,selectall",        theme_advanced_toolbar_location : "top",
        theme_advanced_toolbar_align : "left",
        theme_advanced_resizing : true

};

// test params["language"] = window.external.Language;

// This doesn't seem to help
// params["document_base_url"] = window.external.GetPath();

tinyMCE.init(params);

/*
tinyMCE.init({
        theme : "advanced",
        mode : "textareas",
        plugins : "paste",
        theme_advanced_buttons3_add : "pastetext,pasteword,selectall",
        paste_auto_cleanup_on_paste : true,
        paste_preprocess : function(pl, o) {
            // Content string containing the HTML from the clipboard
            alert(o.content);
            o.content = "-: CLEANED :-\n" + o.content;
        },
        paste_postprocess : function(pl, o) {
            // Content DOM node containing the DOM structure of the clipboard
            alert(o.node.innerHTML);
            o.node.innerHTML = o.node.innerHTML + "\n-: CLEANED :-";
        }
});
*/
</script>

</body>
</html>
